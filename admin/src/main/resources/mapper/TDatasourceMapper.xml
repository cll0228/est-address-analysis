<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lezhi.address.admin.mapper.TDatasourceMapper" >
  <resultMap id="BaseResultMap" type="com.lezhi.address.admin.pojo.TDatasource" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="server" property="server" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="INTEGER" />
    <result column="username" property="username" jdbcType="VARCHAR" />
    <result column="password" property="password" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="VARCHAR" />
    <result column="operator" property="operator" jdbcType="INTEGER" />
    <result column="alias" property="alias" jdbcType="VARCHAR" />
    <result column="delete_flag" property="deleteFlag" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, server, type, username, password, create_time, operator, alias, delete_flag
  </sql>

  <select id="getDataSourceList" resultMap="BaseResultMap">
    select td.*,tu.username as operatorUserName
     from ocn_address.t_datasource td, ocn_address.t_user tu
     where td.operator = tu.id AND td.delete_flag = 0;
  </select>

  <insert id="addServer">
    INSERT INTO ocn_address.t_datasource
    (id, server, type, username, password, operator, alias,delete_flag, create_time)
    VALUES (
    NULL ,
    #{serverIp},
    #{type},
    #{userName},
    #{password},
    #{addStaff},
    #{alias},
    0,
    now()
    )
  </insert>

  <update id="editServer">
    UPDATE ocn_address.t_datasource
    set server=#{serverIp}, type=#{type}, username=#{userName}, password=#{password}, alias=#{alias}, operator=#{operateStaff}
    WHERE id = #{id}
  </update>

  <update id="deleteServer">
    UPDATE ocn_address.t_datasource
    SET operator = #{operateStaff}, delete_flag = 1
    where id = #{id}
  </update>
</mapper>